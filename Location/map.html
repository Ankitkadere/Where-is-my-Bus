<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Location Tracker</title>
  <link rel="icon" href="fav.jpg" type="image/jpeg">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style>
    #map {
      height: 75vh;
      width: 100%;
    }
  </style>
</head>
<body class="bg-gray-100">

  <!-- Header -->
  <div class="text-center bg-sky-700 text-white py-3 font-bold text-lg">
    üìç Live Location Tracker
  </div>

  <!-- Coordinates Display -->
  <div class="text-center my-3">
    <p class="text-gray-700 text-lg">Latitude: <span id="lat" class="font-bold text-green-600">--</span></p>
    <p class="text-gray-700 text-lg">Longitude: <span id="lon" class="font-bold text-blue-600">--</span></p>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <script>
    // Initialize map
    const map = L.map('map').setView([23.1500, 79.8807], 13);

    // Add OpenStreetMap layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap'
    }).addTo(map);

    // Custom location icon
    const myIcon = L.icon({
      iconUrl: 'https://cdn-icons-png.flaticon.com/512/684/684908.png',
      iconSize: [38, 38],
      iconAnchor: [19, 38],
      popupAnchor: [0, -35]
    });

    // Initial marker (will move)
    let marker = L.marker([23.1500, 79.8807], { icon: myIcon })
      .addTo(map)
      .bindPopup("Fetching location...")
      .openPopup();

    // Update coordinates and map
    function updateLocation(position) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

      // Update text display
      document.getElementById("lat").textContent = lat.toFixed(6);
      document.getElementById("lon").textContent = lon.toFixed(6);

      // Move the marker to the new location
      marker.setLatLng([lat, lon]).bindPopup("You are here").openPopup();

      // Center the map on current position
      map.setView([lat, lon]);
    }

    // Error handling
    function showError(error) {
      alert("‚ö†Ô∏è Unable to fetch location. Please enable GPS and allow location access.");
      console.error(error);
    }

    // Request continuous location updates
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(updateLocation, showError, {
        enableHighAccuracy: true,
        maximumAge: 0
      });
    } else {
      alert("‚ùå Geolocation is not supported by your browser.");
    }
  </script>

</body>
</html>
