<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Where is My Bus</title>
  <meta name="description" content="Best app to find buses, live locations, and routes." />
  <link rel="icon" href="logo.jpg" type="image/jpeg" />
  <link rel="apple-touch-icon" href="logo.jpg" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#1a62a3" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="msapplication-navbutton-color" content="#1a62a3" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  <script type="module" src="firebase.js"></script>
  <script src="Blocked.js" defer></script>
  <script src="sw.js"></script>
</head>

<body class="font-inter bg-gray-100 text-gray-900 flex flex-col text-sm">

  <!-- Loader Style -->
  <style>
    #page-loader {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f3f4f6;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }

    #page-loader.fade-out {
      opacity: 0;
      pointer-events: none;
    }
  </style>


  <!-- Page Loader -->
  <!-- <div id="page-loader" class="hidden bg-[#1a62a3]">
    <div class="text-center">
      <i class="fas fa-bus fa-6x text-[#1a62a3] mb-4 animate-bounce"></i>
      <h2 class="text-lg font-extrabold text-[#1a62a3]"> Where Is My Bus...</h2>
    </div>
  </div> -->
  <!-- Loader Script -->
  <script>
    /*  window.addEventListener('load', () => {
        const loader = document.getElementById('page-loader');
        const app = document.getElementById('app');
  
        if (loader) {
          loader.classList.remove('hidden'); // Show loader
          setTimeout(() => {
            loader.classList.add('fade-out');
            setTimeout(() => {
              loader.remove();
              app.classList.remove('hidden'); // Show main app
            }, 500); // Wait for fade-out
          }, 3000); // Show for 3 seconds
        }
      });*/
  </script>

  <header class="bg-[#1a62a3] pt-2 ">
    <div class="flex bottom-4 text-white items-center justify-between w-full px-4  space-x-2 ">
      <div id="mobile-menu-button" aria-label="Toggle menu"
        class="flex items-center gap-4 justify-between text-white hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
        <i class="fas fa-bars text-xl"></i>
        <a href="index.html" class="flex items-center ml-2">
          <h1 class="font-extrabold text-xl leading-none md:pt-3">
            Where is my Bus
          </h1>
        </a>
      </div>


      <div class=" flex gap-2 text-left">
        <!-- Trigger -->
        <div id="menuAppDownload" onclick="toggleMenu()" class=" text-white p-2 rounded-full ">
          <i class="fas fa-mobile-alt text-white text-xl"></i>
        </div>

        <!-- Menu -->
        <div id="menu" onclick="toggleMenu()"
          class="hidden fixed left-0 top-0 w-full h-full mt-2  bg-gray-10 border z-[150] justify-center rounded-lg shadow-lg">

          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
          <style>
            /* Custom animation for fade in/out */
            .fade-in {
              animation: fadeInScale 0.3s forwards;
            }

            .fade-out {
              animation: fadeOutScale 0.3s forwards;
            }

            @keyframes fadeInScale {
              0% {
                opacity: 0;
                transform: scale(0.95);
              }

              100% {
                opacity: 1;
                transform: scale(1);
              }
            }

            @keyframes fadeOutScale {
              0% {
                opacity: 1;
                transform: scale(1);
              }

              100% {
                opacity: 0;
                transform: scale(0.95);
              }
            }
          </style>

          <div class="block  fixed top-0 left-0  text-gray-700 hover:bg-gray-100">
            <button id="PWA"
              class="flex fixed  items-center w-full h-full  justify-center gap-2 bg-black text-white px-6 opacity-70  py-3  font-semibold hover:bg-gray-700 transition">
              <i id="pwaInstallBtn" class="fas fa-mobile-alt text-9xl">
                <p id="installStatusMsg" class="mt-2 text-base text-white"> Install Now</p>
              </i>

            </button>

          </div>

          <script>
            const pwaBtn = document.getElementById('pwaInstallBtn');
            const statusMsg = document.getElementById('installStatusMsg');
            let deferredPrompt = null;
            let appInstalled = false;

            // Disable button until PWA prompt is ready
            pwaBtn.disabled = true;

            // Listen for beforeinstallprompt event
            window.addEventListener('beforeinstallprompt', (e) => {
              e.preventDefault(); // Prevent auto prompt
              deferredPrompt = e;
              pwaBtn.disabled = false;
              statusMsg.textContent = " Install Now";
            });

            // Handle button click
            pwaBtn.addEventListener('click', async () => {
              if (appInstalled) {
                statusMsg.textContent = " Already installed.";
                return;
              }


              if (!deferredPrompt) {
                statusMsg.textContent = "âš ï¸ Your Device Does Not Support App";
                toggleMenu();
                return;
              }

              // Show the PWA install prompt
              deferredPrompt.prompt();
              const choice = await deferredPrompt.userChoice;

              if (choice.outcome === 'accepted') {
                statusMsg.textContent = "ðŸŽ‰ App Installed Successfully!";
                appInstalled = true;
              } else {
                statusMsg.textContent = "âŒ Install Dismissed By User.";
              }

              deferredPrompt = null;
              pwaBtn.disabled = true;
            });

            // Listen for actual app installation
            window.addEventListener('appinstalled', () => {
              statusMsg.textContent = "ðŸŽ‰ App Installed Successfully!";
              appInstalled = true;
              pwaBtn.disabled = true;
            });
          </script>

          <a href="#" class="hidden  block px-4 py-2 text-gray-700 hover:bg-gray-100">
            <i class="fas fa-share mr-2"></i> Share
          </a>
        </div>
        <!-- Settings Button -->
        <div onclick="toggleSetting()" class="text-white p-2 rounded-full cursor-pointer ">
          <i class="fas fa-cog text-white text-xl"></i>
        </div>
        <!-- Overlay + Panel -->
        <div id="menuOverlay" class="fixed inset-0 bg-black/50 hidden z-40 flex justify-center items-start  ">

          <!-- Dropdown Panel -->
          <div id="menuPanel"
            class="w-full max-w-md bg-white shadow-lg transform -translate-y-full transition-transform duration-300 rounded-md">

            <div class="p-4 relative">
              <!-- Close Button -->
              <button onclick="toggleSetting()" title="settings" class="absolute right-4 top-4 text-gray-600 hover:text-black text-xl">
                <i class="fas fa-times"></i>
              </button>
              <!-- NAV CONTENT INSIDE PANEL -->
              <nav class="p-4 ">
                <!-- Top Section -->
                <div class="font-semibold text-gray-800 mb-4 flex items-center justify-between cursor-pointer">
                  <span>SERVICES BY BUS</span>
                  <i class="fas fa-chevron-right text-sm"></i>
                </div>

                <!-- Menu Items Grid: 2 per row -->
                <div class="grid grid-cols-2 gap-3 text-white text-sm">
                  <a href="index.html" class="p-4 rounded-lg bg-blue-500 text-center font-semibold hover:bg-blue-600">
                    <i class="fas fa-home mb-1"></i><br>Home
                  </a>
                  <a href="Adminpenel.html"
                    class="p-4 rounded-lg bg-green-500 text-center font-semibold hover:bg-green-600">
                    <i class="fas fa-user-shield mb-1"></i><br>Booking
                  </a>
                  <a href="Userchat.html"
                    class="p-4 rounded-lg bg-purple-500 text-center font-semibold hover:bg-purple-600">
                    <i class="fas fa-tv mb-1"></i><br>Services
                  </a>
                  <a href="#" class="p-4 rounded-lg bg-red-500 text-center font-semibold hover:bg-red-600">
                    <i class="fas fa-clock mb-1"></i><br>Change Time
                  </a>
                  <a href="#" class="p-4 rounded-lg bg-indigo-500 text-center font-semibold hover:bg-indigo-600">
                    <i class="fas fa-trash mb-1"></i><br>Remove Something
                  </a>
                  <a href="#" class="p-4 rounded-lg bg-teal-500 text-center font-semibold hover:bg-teal-600">
                    <i class="fas fa-map-marker-alt mb-1"></i><br>Add Location
                  </a>
                  <a href="#" class="p-4 rounded-lg bg-orange-500 text-center font-semibold hover:bg-orange-600">
                    <i class="fas fa-bus mb-1"></i><br>Add Buses
                  </a>
                </div>

                <!-- Bottom Bar -->
                <div class="border-t mt-4 pt-4 flex items-center justify-between text-sm">
                  <div onclick="window.location.href='Owner.html'" class="cursor-pointer">
                    <div class="font-semibold text-gray-900">Where is My Bus</div>
                    <div class="text-xs text-gray-500">Whereismybus.com</div>
                  </div>

                  <button title="Profile" onclick="window.location.href='Orderlist.html'"
                    class="text-gray-600 hover:text-blue-600 transition">
                    <i class="fas fa-user text-lg"></i>
                  </button>
                </div>
              </nav>

            </div>

          </div>
        </div>
        <script>
          function toggleSetting() {
            const overlay = document.getElementById("menuOverlay");
            const panel = document.getElementById("menuPanel");

            if (overlay.classList.contains("hidden")) {
              overlay.classList.remove("hidden");
              setTimeout(() => panel.classList.remove("-translate-y-full"), 10);
            } else {
              panel.classList.add("-translate-y-full");
              setTimeout(() => overlay.classList.add("hidden"), 300);
            }
          }

          // Close when clicking outside panel
          document.getElementById("menuOverlay").addEventListener("click", function (e) {
            if (e.target.id === "menuOverlay") toggleSetting();
          });
        </script>

      </div>
    </div>
    <!-- Tabs -->
    <nav class="pt-4 flex border-b border-b-white/50 text-white text-lg font-bold">
      <a href="" onclick="showTab('buses')" id="tab-buses"
        class="flex-1 text-center py-3 border-b-4 border-white select-none">
        Buses
      </a>

      <a href="Booking.html" onclick="showTab('booking')" id="tab-booking" class="flex-1 text-center py-3 select-none">
        Booking
      </a>
    </nav>

    <!-- Script -->
    <script>
      function showTab(tab) {
        // hide all sections
        document.querySelectorAll('.tab-content').forEach(el => {
          el.classList.add('hidden');
        });

        // remove active style
        document.querySelectorAll('[id^="tab-"]').forEach(el => {
          el.classList.remove('border-b-4', 'border-white');
        });

        // show selected section
        document.getElementById(tab).classList.remove('hidden');

        // activate selected tab
        document.getElementById('tab-' + tab)
          .classList.add('border-b-4', 'border-white');
      }
    </script>

  </header>
  <!-- Mobile Side Navbar -->
  <div id="mobile-nav"
    class="bg-white z-[100]  fixed inset-y-0 left-0 w-80  shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out z-50 overflow-y-auto">
    <div class="flex bg-[#1a62a3] items-center justify-between px-4 py-3 border-b border-gray-200">
      <a href="index.html" class="flex items-center text-white space-x-2 pt-2">
        <i class="fas fa-bus fa-3x   "></i>
        <h1 class="font-extrabold w-full pr-2 text-2xl leading-none">
          Where is my Bus
          <span class="font-normal  text-base sm:text-lg ">
            Google
          </span>
        </h1>
      </a>

      <button id="mobile-menu-close" aria-label="Close menu"
        class="text-gray-700 hover:text-gray-900 focus:outline-none">
      </button>
    </div>
    <div class="bg-[#1a62a3] px-1 py-1 border-b border-gray-200">
      <div class="relative w-full">
        <input aria-label="Search for products"
          class="w-full  border border-gray-400 rounded-md py-2 pl-3 pr-10 text-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:border-transparent"
          placeholder="Search For ..." type="search" />

        <span class="absolute inset-y-0 right-3 flex items-center text-gray-500">
          <i class="fas fa-search text-[#1a62a3] text-lg"></i>
        </span>
      </div>
    </div>

    <nav class="text-[#1a62a3 flex flex-col">
      <!-- Top Section -->
      <div class="p-4">
        <!-- Title -->
        <div class="flex items-center justify-between font-semibold text-gray-800 mb-4 cursor-pointer">
          <span>SERVICES BY BUS</span>
          <i class="fas fa-chevron-down text-sm"></i>
        </div>

        <!-- Menu -->
        <ul class="space-y-2 text-sm">
          <li>
            <a href="index.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-home"></i> Home
            </a>
          </li>
          <li>
            <a href="Adminpenel.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-user-shield"></i> Booking
            </a>
          </li>
          <li>
            <a href="Userchat.html" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-tv"></i> Services
            </a>
          </li>
          <li>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-clock"></i> Change Time
            </a>
          </li>
          <li>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-trash"></i> Remove Something
            </a>
          </li>
          <li>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-map-marker-alt"></i> Add Location
            </a>
          </li>
          <li>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-bus"></i> Add Buses
            </a>
          </li>
        </ul>
      </div>

      <!-- Bottom Bar -->
      <div
        class="fixed bottom-0 left-0 w-full border-t bg-white p-4 flex items-center justify-between text-sm shadow-md z-50">

        <div onclick="window.location.href='Owner.html'" class="cursor-pointer">
          <div class="font-semibold">Whereis My Bus</div>
          <div class="text-xs text-gray-500">Whereismybus.com</div>
        </div>

        <button title="Profile" onclick="window.location.href='Orderlist.html'"
          class="text-gray-600 hover:text-blue-600 transition">
          <i class="fas fa-user text-lg"></i>
        </button>
      </div>
    </nav>
  </div>
  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-30 hidden z-[50]" aria-hidden="true"></div>

  <script>

    const mobileMenuButton = document.getElementById("mobile-menu-button");
    const mobileMenuClose = document.getElementById("mobile-menu-close");
    const mobileNav = document.getElementById("mobile-nav");


    function openMenu() {
      mobileNav.classList.remove("-translate-x-full");
      overlay.classList.remove("hidden");
      document.body.style.overflow = "hidden";
    }

    function closeMenu() {
      mobileNav.classList.add("-translate-x-full");
      overlay.classList.add("hidden");
      document.body.style.overflow = "";
    }

    mobileMenuButton.addEventListener("click", openMenu);
    mobileMenuClose.addEventListener("click", closeMenu);
    overlay.addEventListener("click", closeMenu);

    // Modal
    const openBtn = document.getElementById("openModalBtn");
    const closeBtn = document.getElementById("closeModalBtn");
    const closeBtnFooter = document.getElementById("closeModalBtnFooter");
    const modalOverlay = document.getElementById("modalOverlay");
    const modalBox = document.getElementById("modalBox");

    function openModal() {
      modalOverlay.classList.remove("opacity-0", "pointer-events-none");
      modalOverlay.classList.add("opacity-100");
      modalBox.classList.remove("opacity-0", "scale-95", "fade-out");
      modalBox.classList.add("fade-in");
    }

    function closeModal() {
      modalBox.classList.remove("fade-in");
      modalBox.classList.add("fade-out");
      modalOverlay.classList.remove("opacity-100");
      modalOverlay.classList.add("opacity-0");

      setTimeout(() => {
        modalOverlay.classList.add("pointer-events-none");
        modalBox.classList.remove("fade-out");
        modalBox.classList.add("opacity-0", "scale-95");
      }, 300);
    }

    openBtn.addEventListener("click", openModal);
    closeBtn.addEventListener("click", closeModal);
    closeBtnFooter.addEventListener("click", closeModal);
    modalOverlay.addEventListener("click", (e) => {
      if (e.target === modalOverlay) closeModal();
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && !modalOverlay.classList.contains("pointer-events-none")) {
        closeModal();
      }
    });



    // Show modal
    function showModal() {
      modalOverlay.classList.remove("opacity-0", "pointer-events-none");
      modalBox.classList.remove("opacity-0", "scale-95");
      modalOverlay.classList.add("opacity-100");
      modalBox.classList.add("opacity-100", "scale-100");
    }

    // Search input
    const firstinput = document.getElementById("firstinput");
    const searchbtn = document.getElementById("searchbtn");

    window.addEventListener("load", () => {
      firstinput.focus();
      firstinput.select();
    });

    function redirectToCourse() {
      const value = firstinput.value.trim();
      if (value !== "") {
        window.location.href = `Courselist.html?search=${encodeURIComponent(value)}`;
      }
    }

    firstinput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        redirectToCourse();
      }
    });
    searchbtn.addEventListener("click", redirectToCourse);

    // Menu toggle
    function toggleMenu() {
      document.getElementById("menu").classList.toggle("hidden");
    }
    // Simulate progress (alternative random style)
    function simulateProgress(callback) {
      let progress = 0;
      const interval = setInterval(() => {
        if (progress >= 100) {
          clearInterval(interval);
          progress = 100;
          progressBar.style.width = "100%";
          progressText.innerText = "100%";
          statusText.innerText = "App Installed!";
          audio.play();
          setTimeout(() => (appDownload.style.display = "none"), 2000);
          callback();
        } else {
          progress += 5 + Math.random() * 10;
          if (progress > 100) progress = 100;
          progressBar.style.width = `${progress}%`;
          progressText.innerText = `${Math.floor(progress)}%`;
        }
      }, 200);
    }

  </script>
  <script type="module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      signOut,
    } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
    import {
      getFirestore,
      getDoc,
      doc,
    } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

    // âœ… Your Firebase config (USE YOUR OWN VALUES HERE)
    const firebaseConfig = {
      apiKey: "AIzaSyAKN5GR18VTFrKNgVG7FenD4aSTX3Q2PbA",
      authDomain: "gift-zone-project.firebaseapp.com",
      projectId: "gift-zone-project",
      storageBucket: "gift-zone-project.appspot.com",
      messagingSenderId: "806465456032",
      appId: "1:806465456032:web:becf8988a6dfabe43646c5",
      measurementId: "G-1ZLMWBP61Y",
    };

    // âœ… Initialize Firebase services
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // âœ… On Auth Change: fetch and show user data
    onAuthStateChanged(auth, (user) => {
      if (user) {
        const loggedInUserId = localStorage.getItem("loggedInUserId");
        if (!loggedInUserId) {
          console.log("User ID not found in local storage.");
          return;
        }

        const docRef = doc(db, "users", loggedInUserId);
        getDoc(docRef)
          .then((docSnap) => {
            if (docSnap.exists()) {
              const userData = docSnap.data();
              let filt = (document.getElementById("HomeName").innerText =
                userData.firstName || "N/A");
              let ff = (document.getElementById("Homemails").innerText =
                userData.email || "N/A");
              let filts = (document.getElementById("PhoneHomeName").innerText =
                userData.firstName || "N/A");
              let ffd = (document.getElementById("PhoneHomemails").innerText =
                userData.email || "N/A");

              // âœ… Optional: handle missing lastName gracefully
              const lNameElement = document.getElementById("loggedUserLName");
              if (userData.lastName) {
                lNameElement.innerText = userData.lastName;
              } else {
                lNameElement.innerText = "-";
              }
            } else {
              console.log("No user document found in Firestore.");
            }
          })
          .catch((error) => {
            console.error("Error fetching user data:", error);
          });
      } else {
        console.log("User not signed in.");
      }
    });
  </script>
  <span id="Eng" class="hidden"></span>
  <span id="Hi" class="hidden"></span>

  <div id="buses" class="tab-content w-full justify-center  mx-auto space-y-4 mt-0 px-1 md:flex">
    <style>
      .circle-icon {
        width: 45px;
        height: 45px;
        border: 2px solid #086117;
        border-radius: 9999px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        right: 30px;
        top: 95px;
        transform: rotate(90deg);
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.3s ease, border-color 0.3s ease;
        background-color: #f3f3f3;
        z-index: 10;

      }

      .circle-icon:hover {
        border-color: #0b9206;
        transform: scale(1.1);
      }

      .circle-icon svg {
        width: 20px;
        height: 20px;
        color: #20740f;
        transition: color 0.3s ease;
        pointer-events: none;
      }

      /* Suggestion dropdown */
      .suggestions {
        position: absolute;
        margin-top: 3%;
        margin-left: -10%;
        background: white;
        border: 1px solid #d1d5db;
        border-radius: 0.5rem;
        max-height: 200px;
        overflow-y: auto;
        width: 90vw;
        z-index: 20;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .suggestion-item {
        padding: 0.5rem 1rem;
        cursor: pointer;
        font-weight: 700;
        color: #023a6b;
        font-size: 1.2rem;
        border-bottom: 0.1px solid black;
      }

      .suggestion-item:hover,
      .suggestion-item.active {
        background-color: #e9fff4;
        color: #107407;
      }

      input[type="text"] {
        font-weight: 900;
        color: #111827;
        padding: 1% 0px;
        font-size: 1rem;
      }

      button[type="submit"] {
        font-weight: 700;
        border-radius: 10px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      button[type="submit"]:hover {
        transform: translateY(-2px);
        box-shadow: 0 2px 4px #1a62a3;
      }
    </style>
    <!-- Bus Route Search Form -->
    <form
      class="bg-white border md:w-[48%] overflow-hidden border-gray-200 rounded-2xl px-3 pb-6 shadow-md  transition-shadow relative"
      aria-label="Bus search form" onsubmit="return false">

      <h2 class="text-base font-bold text-emerald-700 py-4 tracking-tight flex items-center gap-2">
        <i class="fas fa-map-marker-alt text-emerald-700"></i>
        Route Search
      </h2>

      <!-- From Input -->
      <div class="flex items-center gap-3 bg-white rounded-xl px-4 py-3 shadow-sm border border-gray-400 mb-4">
        <i class="fas fa-map-marker-alt text-emerald-700 text-lg"></i>
        <div class="relative-suggest flex-1">
          <input type="text" id="First" name="get" placeholder="From - Start-Place"
            class="w-full bg-transparent focus:outline-none font-bold text-gray-700" autocomplete="off"
            spellcheck="false" />
          <div id="FirstSuggestions" class="suggestions hidden"></div>
        </div>
      </div>

      <!-- Swap Button -->
      <button type="button" id="swapBtn" class="circle-icon" aria-label="Swap locations" title="Swap locations">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
          <polyline points="16 17 21 12 16 7"></polyline>
          <polyline points="8 7 3 12 8 17"></polyline>
          <line x1="21" y1="12" x2="3" y2="12"></line>
        </svg>
      </button>
      <script>
        const swapBtns = document.getElementById("swapBtn");
        let rotated = false;

        swapBtns.addEventListener("click", () => {
          rotated = !rotated;
          swapBtns.style.transition = "transform 0.3s ease";
          swapBtns.style.transform = rotated ? "rotate(270deg)" : "rotate(90deg)";
        });
      </script>


      <!-- To Input -->
      <div class="flex items-center gap-3 bg-white rounded-xl px-4 py-3  border border-gray-400 mt-3">
        <i class="fas fa-map-marker-alt text-emerald-700 text-lg"></i>

        <div class="relative-suggest flex-1 overflow-hidden">
          <input type="text" id="Second" name="set" placeholder="To - End-Place"
            class="w-full bg-transparent focus:outline-none font-bold text-gray-700" autocomplete="off"
            spellcheck="false" />
          <div id="SecondSuggestions" class="suggestions hidden"></div>
        </div>
      </div>


      <button id="findBusesBtn" type="submit"
        class="w-full bg-green-700 mt-4 hover:bg-green-800 text-white py-3 focus:outline-none ">
        Find Buses
      </button>
    </form>
    <!-- Direct Search Section -->
    <div class="md:w-[48%]">
      <h3 class="text-left font-bold text-emerald-800 text-sm ml-2 uppercase tracking-wide">
        Direct Search
      </h3>

      <form class="bg-white border border-gray-200 rounded-3xl px-3 py-2 shadow-lg hover:shadow-xl transition mt-2"
        aria-label="Live spot search form" onsubmit="return false">
        <!-- Input Card -->
        <div class=" rounded-2xl ">
          <div class="flex items-center gap-3 bg-white rounded-xl px-4 py-3 shadow-sm border border-gray-400">
            <i class="fas fa-bus text-emerald-700 text-lg"></i>
            <div class="relative-suggest flex-1">
              <input type="text" id="numberName" name="numberName" placeholder="Enter Bus Number or Name"
                class="w-full focus:outline-none font-bold text-gray-700" autocomplete="off" spellcheck="false" />
              <div id="NumberNameSuggestions" class="suggestions hidden w-96"></div>
            </div>
          </div>
        </div>
        <!-- Search Button -->
        <button id="searchBtn" type="submit"
          class="mt-5 w-full bg-green-700 hover:from-emerald-800 hover:to-emerald-700 text-white py-3 rounded-xl font-bold shadow-md transition">
          Search
        </button>
      </form>
    </div>
    <!-- Search History-->
    <div class=" md:w-[48%]">
      <h3 class="text-left font-bold text-emerald-800 text-sm ml-2 uppercase tracking-wide"> Search History</h3>
      <div class="mt-2 bg-white border border-gray-200 rounded-2xl p-3 shadow-md">
        <ul id="historyList" class=""></ul>
      </div>
    </div>
    <!-- History Section -->

    <script>
      const fromInput = document.getElementById("First");
      const toInput = document.getElementById("Second");
      const findBtn = document.getElementById("findBusesBtn");
      const historyList = document.getElementById("historyList");


      // Load history from localStorage
      function getHistory() {
        return JSON.parse(localStorage.getItem("busHistory")) || [];
      }

      // Save history to localStorage
      function saveHistory(data) {
        localStorage.setItem("busHistory", JSON.stringify(data));
      }

      // Render history list
      function renderHistory() {
        const history = getHistory();
        historyList.innerHTML = "";

        history.forEach((item, index) => {
          const li = document.createElement("li");
          li.className =
            " ";

          li.innerHTML = ` 
           <a class="flex justify-between items-center px-3 py-3 border-2 rounded-lg" href="Datalist.html?from=${encodeURIComponent(item.from)}&to=${encodeURIComponent(item.to)}">
         <span> <i class="fas fa-bus text-emerald-700 text-lg"></i></span>
   <span class="flex items-center w-72 px-3 cursor-pointer text-gray-700 font-bold">
  <span class="flex-1 text-left">
    ${item.from}
  </span>
  <span class="px-2 text-emerald-700">
    <i class="fas fa-arrow-right text-sm"></i>
  </span>
  <span class="flex-1 text-right">
    ${item.to}
  </span>
</span>
        <button class="text-red-500 text-sm"><i class="fas fa-chevron-right text-emerald-700 text-lg"></i>
</button> </a>
      `;

          // Click to reuse
          li.querySelector("span").addEventListener("click", () => {
            fromInput.value = item.from;
            toInput.value = item.to;
          });

          // Delete item
          function limitHistory() {
            let history = getHistory();
            if (history.length > 4) {
              history.splice(4);
              saveHistory(history);
            }
          }
          function addToHistory(from, to) {
            let history = getHistory();

            // Remove duplicate
            history = history.filter(
              (item) => item.from !== from || item.to !== to
            );

            // Add new item on top
            history.unshift({ from, to });

            // If more than 4, remove extras from bottom
            if (history.length > 4) {
              history.splice(4); // keep only first 4
            }

            saveHistory(history);
            renderHistory();
          }


          historyList.appendChild(li);
        });
      }

      // Add to history
      function addToHistory(from, to) {
        let history = getHistory();

        // Prevent duplicates
        history = history.filter(
          (item) => item.from !== from || item.to !== to
        );

        history.unshift({ from, to }); // add on top
        history = history.slice(0, 4); // keep last 4 items

        saveHistory(history);
        renderHistory();
      }

      // On Find Buses click
      findBtn.addEventListener("click", () => {
        const from = fromInput.value.trim();
        const to = toInput.value.trim();

        if (from && to) {
          addToHistory(from, to);
          // continue your bus search logic here
        }
      });

      // Initial load
      renderHistory();
    </script>

  </div>
  <!-- Tab Sections -->
  <div id="booking" class="tab-content hidden">
  </div>
</body>
<script>
  document.getElementById("findBusesBtn").addEventListener("click", () => {
    const from = document.getElementById("First").value.trim();
    const to = document.getElementById("Second").value.trim();

    if (!from || !to) {
      alert("Please fill both From and To fields");
      return;
    }

    window.location.href = `Datalist.html?from=${encodeURIComponent(
      from
    )}&to=${encodeURIComponent(to)}`;
  });
  document.getElementById("searchBtn").addEventListener("click", () => {
    let value = document.getElementById("numberName").value.trim();

    // Extract code and name
    let code = value.slice(0, 6).trim();
    let name = value.slice(8).trim();

    if (!code) {
      alert("Enter a valid value");
      return;
    }
    window.location.href = `Map.html?number=${encodeURIComponent(code)}&name=${encodeURIComponent(name)}`;
  });

  // Data arrays for suggestions - city names
  const cities = [
    "JBP - Jabalpur",
    "BPL - Bhopal",
    "MDL - Medical",
    "Shahpura",
    "IND - Indore",
    "Nagpur",
    "Raipur",
    "Bilaspur",
    "Satna",
    "Gwalior",
    "Rewa",
    "Chhindwara",
    "Ujjain",
    "Sagar",
    "Durg",
    "Korba",
    "Raigarh",
    "Mumbai",
    "Delhi",
    "Chennai",
    "Kolkata",
    "Pune",
    "Ahmedabad",
    "Surat",
    "Jaipur",
    "Lucknow",
    "Kanpur",
    "Visakhapatnam",
    "Bangalore",
    "Hyderabad",
    "Coimbatore",
  ];

  // Data arrays for buses
  const buses = [
    { code: "00101", en: "Choudhary", hi: "à¤šà¥Œà¤§à¤°à¥€" },
    { code: "00102", en: "Choudhary", hi: "à¤šà¥Œà¤§à¤°à¥€" },
    { code: "00102", en: "Rathore", hi: "à¤°à¤¾à¤ à¥Œà¤°" },
    { code: "00103", en: "Sharma", hi: "à¤¶à¤°à¥à¤®à¤¾" },
    { code: "00104", en: "Verma", hi: "à¤µà¤°à¥à¤®à¤¾" },
    { code: "00105", en: "Yadav", hi: "à¤¯à¤¾à¤¦à¤µ" },
    { code: "00106", en: "Patel", hi: "à¤ªà¤Ÿà¥‡à¤²" },
    { code: "00107", en: "Thakur", hi: "à¤ à¤¾à¤•à¥à¤°" },
    { code: "00108", en: "Khan", hi: "à¤–à¤¾à¤¨" },
    { code: "00109", en: "Meena", hi: "à¤®à¥€à¤£à¤¾" },
    { code: "00110", en: "Gupta", hi: "à¤—à¥à¤ªà¥à¤¤à¤¾" },
    { code: "00111", en: "Pandey", hi: "à¤ªà¤¾à¤‚à¤¡à¥‡à¤¯" },
    { code: "00112", en: "Tiwari", hi: "à¤¤à¤¿à¤µà¤¾à¤°à¥€" },
    { code: "00113", en: "Jha", hi: "à¤à¤¾" },
    { code: "00114", en: "Saxena", hi: "à¤¸à¤•à¥à¤¸à¥‡à¤¨à¤¾" },
    { code: "00115", en: "Dubey", hi: "à¤¦à¥à¤¬à¥‡" },
  ];

  // Utility function to create suggestion items
  function createSuggestionItem(text) {
    const div = document.createElement("div");
    div.classList.add("suggestion-item");
    div.setAttribute("role", "option");
    div.textContent = text;
    return div;
  }

  // Generic function to handle input and suggestions
  function setupAutocomplete(inputEl, suggestionsEl, dataList) {
    let selectedIndex = -1;

    inputEl.addEventListener("input", () => {
      const val = inputEl.value.trim().toLowerCase();
      suggestionsEl.innerHTML = "";
      selectedIndex = -1;
      if (!val) {
        suggestionsEl.classList.add("hidden");
        return;
      }
      const filtered = dataList.filter((item) =>
        item.toLowerCase().includes(val)
      );
      if (filtered.length === 0) {
        suggestionsEl.classList.add("hidden");
        return;
      }
      filtered.forEach((item) => {
        const suggestionItem = createSuggestionItem(item);
        suggestionItem.addEventListener("mousedown", (e) => {
          e.preventDefault(); // Prevent losing focus
          inputEl.value = item;
          suggestionsEl.classList.add("hidden");
        });
        suggestionsEl.appendChild(suggestionItem);
      });
      suggestionsEl.classList.remove("hidden");
    });

    // Hide suggestions on blur with slight delay to allow click
    inputEl.addEventListener("blur", () => {
      setTimeout(() => {
        suggestionsEl.classList.add("hidden");
        selectedIndex = -1;
      }, 150);
    });

    // Keyboard navigation
    inputEl.addEventListener("keydown", (e) => {
      const items = suggestionsEl.querySelectorAll(".suggestion-item");
      if (items.length === 0) return;

      if (e.key === "ArrowDown") {
        e.preventDefault();
        selectedIndex = (selectedIndex + 1) % items.length;
        updateActive(items, selectedIndex);
      } else if (e.key === "ArrowUp") {
        e.preventDefault();
        selectedIndex = (selectedIndex - 1 + items.length) % items.length;
        updateActive(items, selectedIndex);
      } else if (e.key === "Enter") {
        if (selectedIndex >= 0 && selectedIndex < items.length) {
          e.preventDefault();
          inputEl.value = items[selectedIndex].textContent;
          suggestionsEl.classList.add("hidden");
          selectedIndex = -1;
        }
      } else {
        selectedIndex = -1;
        updateActive(items, selectedIndex);
      }
    });

    function updateActive(items, index) {
      items.forEach((item, i) => {
        if (i === index) {
          item.classList.add("active");
          item.setAttribute("aria-selected", "true");
          item.scrollIntoView({ block: "nearest" });
        } else {
          item.classList.remove("active");
          item.removeAttribute("aria-selected");
        }
      });
    }
  }

  // Setup autocomplete for each input
  setupAutocomplete(
    document.getElementById("First"),
    document.getElementById("FirstSuggestions"),
    cities
  );
  setupAutocomplete(
    document.getElementById("Second"),
    document.getElementById("SecondSuggestions"),
    cities
  );
  setupAutocomplete(
    document.getElementById("numberName"),
    document.getElementById("NumberNameSuggestions"),
    buses.map((bus) => `${bus.code} : ${bus.en} / ${bus.hi}`)
  );

  // Swap button functionality
  const swapBtn = document.getElementById("swapBtn");
  const firstInput = document.getElementById("First");
  const secondInput = document.getElementById("Second");

  swapBtn.addEventListener("click", () => {
    const temp = firstInput.value;
    firstInput.value = secondInput.value;
    secondInput.value = temp;
    firstInput.focus();
  });
  ///////First Swap Second///////

  //////////////////////////////

</script>
<script>
  /*
  window.OneSignalDeferred = window.OneSignalDeferred || [];
  OneSignalDeferred.push(async function (OneSignal) {
    await OneSignal.init({
      appId: "3fa7f09b-cf8a-43dd-9ec7-8defe4142b00",
      notifyButton: {
        enable: true
      }
    });
  });*/
</script>

</html>